CREATE OR REPLACE FUNCTION `__PROJECTID__.__DATASET__.significance_level_ttest2__VERSIONTAG__`(df INT64, tscore FLOAT64) RETURNS FLOAT64
OPTIONS (description="Persistent function that determines if the p-value of a two-sided T test is smaller than  0.05, 0.01, 0.005, or 0.001 (common significance levels). It is used to filter out correlations that are not statistically significant (p-value > significance_level).\nPARAMETERS:  df( degrees of freedom, INT64) and tscore (the t statistics, FLOAT64).\nOUTPUT: One of the 6 possible upper bounds of the p-value : 1.0, 0.05,0.01,0.005,0.001,0.0.\nVERSION: 1.1\nNOTE1: This function only works for df < 500. df>500 we recommend the normal approximation of the t distribution.\nNOTE2:The previous function isb-cgc.functions.significance_level_ttest2 had a bug and has been dropped.\nEXAMPLE: https://github.com/isb-cgc/Community-Notebooks/blob/master/RegulomeExplorer/AllPairs-correlation-GeneExpression-MicroRNA.ipynb") AS (

(

WITH Ttable AS (
    SELECT
        #0.05, 0.01, 0.005, 0.001
[STRUCT( [   12.7062,   63.6567,  127.3213,  636.6192] as t),
STRUCT( [    4.3027,    9.9248,   14.0890,   31.5991] as t),
STRUCT( [    3.1824,    5.8409,    7.4533,   12.9240] as t),
STRUCT( [    2.7764,    4.6041,    5.5976,    8.6103] as t),
STRUCT( [    2.5706,    4.0321,    4.7733,    6.8688] as t),
STRUCT( [    2.4469,    3.7074,    4.3168,    5.9588] as t),
STRUCT( [    2.3646,    3.4995,    4.0293,    5.4079] as t),
STRUCT( [    2.3060,    3.3554,    3.8325,    5.0413] as t),
STRUCT( [    2.2622,    3.2498,    3.6897,    4.7809] as t),
STRUCT( [    2.2281,    3.1693,    3.5814,    4.5869] as t),
STRUCT( [    2.2010,    3.1058,    3.4966,    4.4370] as t),
STRUCT( [    2.1788,    3.0545,    3.4284,    4.3178] as t),
STRUCT( [    2.1604,    3.0123,    3.3725,    4.2208] as t),
STRUCT( [    2.1448,    2.9768,    3.3257,    4.1405] as t),
STRUCT( [    2.1314,    2.9467,    3.2860,    4.0728] as t),
STRUCT( [    2.1199,    2.9208,    3.2520,    4.0150] as t),
STRUCT( [    2.1098,    2.8982,    3.2224,    3.9651] as t),
STRUCT( [    2.1009,    2.8784,    3.1966,    3.9216] as t),
STRUCT( [    2.0930,    2.8609,    3.1737,    3.8834] as t),
STRUCT( [    2.0860,    2.8453,    3.1534,    3.8495] as t),
STRUCT( [    2.0796,    2.8314,    3.1352,    3.8193] as t),
STRUCT( [    2.0739,    2.8188,    3.1188,    3.7921] as t),
STRUCT( [    2.0687,    2.8073,    3.1040,    3.7676] as t),
STRUCT( [    2.0639,    2.7969,    3.0905,    3.7454] as t),
STRUCT( [    2.0595,    2.7874,    3.0782,    3.7251] as t),
STRUCT( [    2.0555,    2.7787,    3.0669,    3.7066] as t),
STRUCT( [    2.0518,    2.7707,    3.0565,    3.6896] as t),
STRUCT( [    2.0484,    2.7633,    3.0469,    3.6739] as t),
STRUCT( [    2.0452,    2.7564,    3.0380,    3.6594] as t),
STRUCT( [    2.0423,    2.7500,    3.0298,    3.6460] as t),
STRUCT( [    2.0395,    2.7440,    3.0221,    3.6335] as t),
STRUCT( [    2.0369,    2.7385,    3.0149,    3.6218] as t),
STRUCT( [    2.0345,    2.7333,    3.0082,    3.6109] as t),
STRUCT( [    2.0322,    2.7284,    3.0020,    3.6007] as t),
STRUCT( [    2.0301,    2.7238,    2.9960,    3.5911] as t),
STRUCT( [    2.0281,    2.7195,    2.9905,    3.5821] as t),
STRUCT( [    2.0262,    2.7154,    2.9852,    3.5737] as t),
STRUCT( [    2.0244,    2.7116,    2.9803,    3.5657] as t),
STRUCT( [    2.0227,    2.7079,    2.9756,    3.5581] as t),
STRUCT( [    2.0211,    2.7045,    2.9712,    3.5510] as t),
STRUCT( [    2.0195,    2.7012,    2.9670,    3.5442] as t),
STRUCT( [    2.0181,    2.6981,    2.9630,    3.5377] as t),
STRUCT( [    2.0167,    2.6951,    2.9592,    3.5316] as t),
STRUCT( [    2.0154,    2.6923,    2.9555,    3.5258] as t),
STRUCT( [    2.0141,    2.6896,    2.9521,    3.5203] as t),
STRUCT( [    2.0129,    2.6870,    2.9488,    3.5150] as t),
STRUCT( [    2.0117,    2.6846,    2.9456,    3.5099] as t),
STRUCT( [    2.0106,    2.6822,    2.9426,    3.5051] as t),
STRUCT( [    2.0096,    2.6800,    2.9397,    3.5004] as t),
STRUCT( [    2.0086,    2.6778,    2.9370,    3.4960] as t),
STRUCT( [    2.0076,    2.6757,    2.9343,    3.4918] as t),
STRUCT( [    2.0066,    2.6737,    2.9318,    3.4877] as t),
STRUCT( [    2.0057,    2.6718,    2.9293,    3.4838] as t),
STRUCT( [    2.0049,    2.6700,    2.9270,    3.4800] as t),
STRUCT( [    2.0040,    2.6682,    2.9247,    3.4764] as t),
STRUCT( [    2.0032,    2.6665,    2.9225,    3.4729] as t),
STRUCT( [    2.0025,    2.6649,    2.9204,    3.4696] as t),
STRUCT( [    2.0017,    2.6633,    2.9184,    3.4663] as t),
STRUCT( [    2.0010,    2.6618,    2.9164,    3.4632] as t),
STRUCT( [    2.0003,    2.6603,    2.9146,    3.4602] as t),
STRUCT( [    1.9996,    2.6589,    2.9127,    3.4573] as t),
STRUCT( [    1.9990,    2.6575,    2.9110,    3.4545] as t),
STRUCT( [    1.9983,    2.6561,    2.9093,    3.4518] as t),
STRUCT( [    1.9977,    2.6549,    2.9076,    3.4491] as t),
STRUCT( [    1.9971,    2.6536,    2.9060,    3.4466] as t),
STRUCT( [    1.9966,    2.6524,    2.9045,    3.4441] as t),
STRUCT( [    1.9960,    2.6512,    2.9030,    3.4417] as t),
STRUCT( [    1.9955,    2.6501,    2.9015,    3.4394] as t),
STRUCT( [    1.9949,    2.6490,    2.9001,    3.4372] as t),
STRUCT( [    1.9944,    2.6479,    2.8987,    3.4350] as t),
STRUCT( [    1.9939,    2.6469,    2.8974,    3.4329] as t),
STRUCT( [    1.9935,    2.6459,    2.8961,    3.4308] as t),
STRUCT( [    1.9930,    2.6449,    2.8949,    3.4289] as t),
STRUCT( [    1.9925,    2.6439,    2.8936,    3.4269] as t),
STRUCT( [    1.9921,    2.6430,    2.8924,    3.4250] as t),
STRUCT( [    1.9917,    2.6421,    2.8913,    3.4232] as t),
STRUCT( [    1.9913,    2.6412,    2.8902,    3.4214] as t),
STRUCT( [    1.9908,    2.6403,    2.8891,    3.4197] as t),
STRUCT( [    1.9905,    2.6395,    2.8880,    3.4180] as t),
STRUCT( [    1.9901,    2.6387,    2.8870,    3.4163] as t),
STRUCT( [    1.9897,    2.6379,    2.8860,    3.4147] as t),
STRUCT( [    1.9893,    2.6371,    2.8850,    3.4132] as t),
STRUCT( [    1.9890,    2.6364,    2.8840,    3.4116] as t),
STRUCT( [    1.9886,    2.6356,    2.8831,    3.4102] as t),
STRUCT( [    1.9883,    2.6349,    2.8822,    3.4087] as t),
STRUCT( [    1.9879,    2.6342,    2.8813,    3.4073] as t),
STRUCT( [    1.9876,    2.6335,    2.8804,    3.4059] as t),
STRUCT( [    1.9873,    2.6329,    2.8795,    3.4045] as t),
STRUCT( [    1.9870,    2.6322,    2.8787,    3.4032] as t),
STRUCT( [    1.9867,    2.6316,    2.8779,    3.4019] as t),
STRUCT( [    1.9864,    2.6309,    2.8771,    3.4007] as t),
STRUCT( [    1.9861,    2.6303,    2.8763,    3.3994] as t),
STRUCT( [    1.9858,    2.6297,    2.8755,    3.3982] as t),
STRUCT( [    1.9855,    2.6291,    2.8748,    3.3971] as t),
STRUCT( [    1.9853,    2.6286,    2.8741,    3.3959] as t),
STRUCT( [    1.9850,    2.6280,    2.8734,    3.3948] as t),
STRUCT( [    1.9847,    2.6275,    2.8727,    3.3937] as t),
STRUCT( [    1.9845,    2.6269,    2.8720,    3.3926] as t),
STRUCT( [    1.9842,    2.6264,    2.8713,    3.3915] as t),
STRUCT( [    1.9840,    2.6259,    2.8707,    3.3905] as t),
STRUCT( [    1.9837,    2.6254,    2.8700,    3.3895] as t),
STRUCT( [    1.9835,    2.6249,    2.8694,    3.3885] as t),
STRUCT( [    1.9833,    2.6244,    2.8688,    3.3875] as t),
STRUCT( [    1.9830,    2.6239,    2.8682,    3.3865] as t),
STRUCT( [    1.9828,    2.6235,    2.8676,    3.3856] as t),
STRUCT( [    1.9826,    2.6230,    2.8670,    3.3847] as t),
STRUCT( [    1.9824,    2.6226,    2.8664,    3.3838] as t),
STRUCT( [    1.9822,    2.6221,    2.8658,    3.3829] as t),
STRUCT( [    1.9820,    2.6217,    2.8653,    3.3820] as t),
STRUCT( [    1.9818,    2.6213,    2.8648,    3.3812] as t),
STRUCT( [    1.9816,    2.6208,    2.8642,    3.3803] as t),
STRUCT( [    1.9814,    2.6204,    2.8637,    3.3795] as t),
STRUCT( [    1.9812,    2.6200,    2.8632,    3.3787] as t),
STRUCT( [    1.9810,    2.6196,    2.8627,    3.3779] as t),
STRUCT( [    1.9808,    2.6193,    2.8622,    3.3771] as t),
STRUCT( [    1.9806,    2.6189,    2.8617,    3.3764] as t),
STRUCT( [    1.9804,    2.6185,    2.8612,    3.3756] as t),
STRUCT( [    1.9803,    2.6181,    2.8608,    3.3749] as t),
STRUCT( [    1.9801,    2.6178,    2.8603,    3.3742] as t),
STRUCT( [    1.9799,    2.6174,    2.8599,    3.3735] as t),
STRUCT( [    1.9798,    2.6171,    2.8594,    3.3728] as t),
STRUCT( [    1.9796,    2.6167,    2.8590,    3.3721] as t),
STRUCT( [    1.9794,    2.6164,    2.8586,    3.3714] as t),
STRUCT( [    1.9793,    2.6161,    2.8581,    3.3707] as t),
STRUCT( [    1.9791,    2.6157,    2.8577,    3.3701] as t),
STRUCT( [    1.9790,    2.6154,    2.8573,    3.3694] as t),
STRUCT( [    1.9788,    2.6151,    2.8569,    3.3688] as t),
STRUCT( [    1.9787,    2.6148,    2.8565,    3.3682] as t),
STRUCT( [    1.9785,    2.6145,    2.8561,    3.3675] as t),
STRUCT( [    1.9784,    2.6142,    2.8557,    3.3669] as t),
STRUCT( [    1.9782,    2.6139,    2.8554,    3.3663] as t),
STRUCT( [    1.9781,    2.6136,    2.8550,    3.3658] as t),
STRUCT( [    1.9780,    2.6133,    2.8546,    3.3652] as t),
STRUCT( [    1.9778,    2.6130,    2.8543,    3.3646] as t),
STRUCT( [    1.9777,    2.6127,    2.8539,    3.3641] as t),
STRUCT( [    1.9776,    2.6125,    2.8536,    3.3635] as t),
STRUCT( [    1.9774,    2.6122,    2.8532,    3.3630] as t),
STRUCT( [    1.9773,    2.6119,    2.8529,    3.3624] as t),
STRUCT( [    1.9772,    2.6117,    2.8525,    3.3619] as t),
STRUCT( [    1.9771,    2.6114,    2.8522,    3.3614] as t),
STRUCT( [    1.9769,    2.6111,    2.8519,    3.3609] as t),
STRUCT( [    1.9768,    2.6109,    2.8516,    3.3604] as t),
STRUCT( [    1.9767,    2.6106,    2.8512,    3.3599] as t),
STRUCT( [    1.9766,    2.6104,    2.8509,    3.3594] as t),
STRUCT( [    1.9765,    2.6102,    2.8506,    3.3589] as t),
STRUCT( [    1.9763,    2.6099,    2.8503,    3.3584] as t),
STRUCT( [    1.9762,    2.6097,    2.8500,    3.3579] as t),
STRUCT( [    1.9761,    2.6095,    2.8497,    3.3575] as t),
STRUCT( [    1.9760,    2.6092,    2.8494,    3.3570] as t),
STRUCT( [    1.9759,    2.6090,    2.8492,    3.3566] as t),
STRUCT( [    1.9758,    2.6088,    2.8489,    3.3561] as t),
STRUCT( [    1.9757,    2.6086,    2.8486,    3.3557] as t),
STRUCT( [    1.9756,    2.6083,    2.8483,    3.3553] as t),
STRUCT( [    1.9755,    2.6081,    2.8480,    3.3548] as t),
STRUCT( [    1.9754,    2.6079,    2.8478,    3.3544] as t),
STRUCT( [    1.9753,    2.6077,    2.8475,    3.3540] as t),
STRUCT( [    1.9752,    2.6075,    2.8472,    3.3536] as t),
STRUCT( [    1.9751,    2.6073,    2.8470,    3.3532] as t),
STRUCT( [    1.9750,    2.6071,    2.8467,    3.3528] as t),
STRUCT( [    1.9749,    2.6069,    2.8465,    3.3524] as t),
STRUCT( [    1.9748,    2.6067,    2.8462,    3.3520] as t),
STRUCT( [    1.9747,    2.6065,    2.8460,    3.3516] as t),
STRUCT( [    1.9746,    2.6063,    2.8458,    3.3512] as t),
STRUCT( [    1.9745,    2.6061,    2.8455,    3.3508] as t),
STRUCT( [    1.9744,    2.6060,    2.8453,    3.3505] as t),
STRUCT( [    1.9744,    2.6058,    2.8450,    3.3501] as t),
STRUCT( [    1.9743,    2.6056,    2.8448,    3.3497] as t),
STRUCT( [    1.9742,    2.6054,    2.8446,    3.3494] as t),
STRUCT( [    1.9741,    2.6052,    2.8444,    3.3490] as t),
STRUCT( [    1.9740,    2.6051,    2.8441,    3.3487] as t),
STRUCT( [    1.9739,    2.6049,    2.8439,    3.3483] as t),
STRUCT( [    1.9739,    2.6047,    2.8437,    3.3480] as t),
STRUCT( [    1.9738,    2.6045,    2.8435,    3.3477] as t),
STRUCT( [    1.9737,    2.6044,    2.8433,    3.3473] as t),
STRUCT( [    1.9736,    2.6042,    2.8431,    3.3470] as t),
STRUCT( [    1.9735,    2.6041,    2.8429,    3.3467] as t),
STRUCT( [    1.9735,    2.6039,    2.8427,    3.3463] as t),
STRUCT( [    1.9734,    2.6037,    2.8424,    3.3460] as t),
STRUCT( [    1.9733,    2.6036,    2.8422,    3.3457] as t),
STRUCT( [    1.9732,    2.6034,    2.8421,    3.3454] as t),
STRUCT( [    1.9732,    2.6033,    2.8419,    3.3451] as t),
STRUCT( [    1.9731,    2.6031,    2.8417,    3.3448] as t),
STRUCT( [    1.9730,    2.6030,    2.8415,    3.3445] as t),
STRUCT( [    1.9729,    2.6028,    2.8413,    3.3442] as t),
STRUCT( [    1.9729,    2.6027,    2.8411,    3.3439] as t),
STRUCT( [    1.9728,    2.6025,    2.8409,    3.3436] as t),
STRUCT( [    1.9727,    2.6024,    2.8407,    3.3433] as t),
STRUCT( [    1.9727,    2.6022,    2.8405,    3.3430] as t),
STRUCT( [    1.9726,    2.6021,    2.8404,    3.3427] as t),
STRUCT( [    1.9725,    2.6020,    2.8402,    3.3425] as t),
STRUCT( [    1.9725,    2.6018,    2.8400,    3.3422] as t),
STRUCT( [    1.9724,    2.6017,    2.8398,    3.3419] as t),
STRUCT( [    1.9723,    2.6015,    2.8397,    3.3416] as t),
STRUCT( [    1.9723,    2.6014,    2.8395,    3.3414] as t),
STRUCT( [    1.9722,    2.6013,    2.8393,    3.3411] as t),
STRUCT( [    1.9721,    2.6011,    2.8392,    3.3409] as t),
STRUCT( [    1.9721,    2.6010,    2.8390,    3.3406] as t),
STRUCT( [    1.9720,    2.6009,    2.8388,    3.3403] as t),
STRUCT( [    1.9720,    2.6008,    2.8387,    3.3401] as t),
STRUCT( [    1.9719,    2.6006,    2.8385,    3.3398] as t),
STRUCT( [    1.9718,    2.6005,    2.8384,    3.3396] as t),
STRUCT( [    1.9718,    2.6004,    2.8382,    3.3393] as t),
STRUCT( [    1.9717,    2.6003,    2.8380,    3.3391] as t),
STRUCT( [    1.9717,    2.6001,    2.8379,    3.3389] as t),
STRUCT( [    1.9716,    2.6000,    2.8377,    3.3386] as t),
STRUCT( [    1.9715,    2.5999,    2.8376,    3.3384] as t),
STRUCT( [    1.9715,    2.5998,    2.8374,    3.3381] as t),
STRUCT( [    1.9714,    2.5997,    2.8373,    3.3379] as t),
STRUCT( [    1.9714,    2.5996,    2.8371,    3.3377] as t),
STRUCT( [    1.9713,    2.5994,    2.8370,    3.3375] as t),
STRUCT( [    1.9713,    2.5993,    2.8369,    3.3372] as t),
STRUCT( [    1.9712,    2.5992,    2.8367,    3.3370] as t),
STRUCT( [    1.9712,    2.5991,    2.8366,    3.3368] as t),
STRUCT( [    1.9711,    2.5990,    2.8364,    3.3366] as t),
STRUCT( [    1.9711,    2.5989,    2.8363,    3.3364] as t),
STRUCT( [    1.9710,    2.5988,    2.8362,    3.3361] as t),
STRUCT( [    1.9710,    2.5987,    2.8360,    3.3359] as t),
STRUCT( [    1.9709,    2.5986,    2.8359,    3.3357] as t),
STRUCT( [    1.9709,    2.5985,    2.8358,    3.3355] as t),
STRUCT( [    1.9708,    2.5984,    2.8356,    3.3353] as t),
STRUCT( [    1.9708,    2.5983,    2.8355,    3.3351] as t),
STRUCT( [    1.9707,    2.5982,    2.8354,    3.3349] as t),
STRUCT( [    1.9707,    2.5981,    2.8352,    3.3347] as t),
STRUCT( [    1.9706,    2.5980,    2.8351,    3.3345] as t),
STRUCT( [    1.9706,    2.5979,    2.8350,    3.3343] as t),
STRUCT( [    1.9705,    2.5978,    2.8349,    3.3341] as t),
STRUCT( [    1.9705,    2.5977,    2.8347,    3.3339] as t),
STRUCT( [    1.9704,    2.5976,    2.8346,    3.3337] as t),
STRUCT( [    1.9704,    2.5975,    2.8345,    3.3335] as t),
STRUCT( [    1.9703,    2.5974,    2.8344,    3.3333] as t),
STRUCT( [    1.9703,    2.5973,    2.8343,    3.3331] as t),
STRUCT( [    1.9702,    2.5972,    2.8341,    3.3330] as t),
STRUCT( [    1.9702,    2.5971,    2.8340,    3.3328] as t),
STRUCT( [    1.9702,    2.5970,    2.8339,    3.3326] as t),
STRUCT( [    1.9701,    2.5969,    2.8338,    3.3324] as t),
STRUCT( [    1.9701,    2.5968,    2.8337,    3.3322] as t),
STRUCT( [    1.9700,    2.5967,    2.8336,    3.3320] as t),
STRUCT( [    1.9700,    2.5966,    2.8334,    3.3319] as t),
STRUCT( [    1.9699,    2.5966,    2.8333,    3.3317] as t),
STRUCT( [    1.9699,    2.5965,    2.8332,    3.3315] as t),
STRUCT( [    1.9699,    2.5964,    2.8331,    3.3314] as t),
STRUCT( [    1.9698,    2.5963,    2.8330,    3.3312] as t),
STRUCT( [    1.9698,    2.5962,    2.8329,    3.3310] as t),
STRUCT( [    1.9697,    2.5961,    2.8328,    3.3308] as t),
STRUCT( [    1.9697,    2.5960,    2.8327,    3.3307] as t),
STRUCT( [    1.9697,    2.5960,    2.8326,    3.3305] as t),
STRUCT( [    1.9696,    2.5959,    2.8325,    3.3304] as t),
STRUCT( [    1.9696,    2.5958,    2.8324,    3.3302] as t),
STRUCT( [    1.9695,    2.5957,    2.8323,    3.3300] as t),
STRUCT( [    1.9695,    2.5956,    2.8322,    3.3299] as t),
STRUCT( [    1.9695,    2.5956,    2.8321,    3.3297] as t),
STRUCT( [    1.9694,    2.5955,    2.8320,    3.3296] as t),
STRUCT( [    1.9694,    2.5954,    2.8319,    3.3294] as t),
STRUCT( [    1.9693,    2.5953,    2.8318,    3.3292] as t),
STRUCT( [    1.9693,    2.5952,    2.8317,    3.3291] as t),
STRUCT( [    1.9693,    2.5952,    2.8316,    3.3289] as t),
STRUCT( [    1.9692,    2.5951,    2.8315,    3.3288] as t),
STRUCT( [    1.9692,    2.5950,    2.8314,    3.3286] as t),
STRUCT( [    1.9692,    2.5949,    2.8313,    3.3285] as t),
STRUCT( [    1.9691,    2.5949,    2.8312,    3.3283] as t),
STRUCT( [    1.9691,    2.5948,    2.8311,    3.3282] as t),
STRUCT( [    1.9691,    2.5947,    2.8310,    3.3280] as t),
STRUCT( [    1.9690,    2.5947,    2.8309,    3.3279] as t),
STRUCT( [    1.9690,    2.5946,    2.8308,    3.3278] as t),
STRUCT( [    1.9690,    2.5945,    2.8307,    3.3276] as t),
STRUCT( [    1.9689,    2.5944,    2.8306,    3.3275] as t),
STRUCT( [    1.9689,    2.5944,    2.8306,    3.3273] as t),
STRUCT( [    1.9689,    2.5943,    2.8305,    3.3272] as t),
STRUCT( [    1.9688,    2.5942,    2.8304,    3.3271] as t),
STRUCT( [    1.9688,    2.5942,    2.8303,    3.3269] as t),
STRUCT( [    1.9688,    2.5941,    2.8302,    3.3268] as t),
STRUCT( [    1.9687,    2.5940,    2.8301,    3.3267] as t),
STRUCT( [    1.9687,    2.5940,    2.8300,    3.3265] as t),
STRUCT( [    1.9687,    2.5939,    2.8299,    3.3264] as t),
STRUCT( [    1.9686,    2.5938,    2.8299,    3.3263] as t),
STRUCT( [    1.9686,    2.5938,    2.8298,    3.3261] as t),
STRUCT( [    1.9686,    2.5937,    2.8297,    3.3260] as t),
STRUCT( [    1.9685,    2.5936,    2.8296,    3.3259] as t),
STRUCT( [    1.9685,    2.5936,    2.8295,    3.3257] as t),
STRUCT( [    1.9685,    2.5935,    2.8295,    3.3256] as t),
STRUCT( [    1.9684,    2.5934,    2.8294,    3.3255] as t),
STRUCT( [    1.9684,    2.5934,    2.8293,    3.3254] as t),
STRUCT( [    1.9684,    2.5933,    2.8292,    3.3252] as t),
STRUCT( [    1.9684,    2.5933,    2.8291,    3.3251] as t),
STRUCT( [    1.9683,    2.5932,    2.8291,    3.3250] as t),
STRUCT( [    1.9683,    2.5931,    2.8290,    3.3249] as t),
STRUCT( [    1.9683,    2.5931,    2.8289,    3.3247] as t),
STRUCT( [    1.9682,    2.5930,    2.8288,    3.3246] as t),
STRUCT( [    1.9682,    2.5929,    2.8287,    3.3245] as t),
STRUCT( [    1.9682,    2.5929,    2.8287,    3.3244] as t),
STRUCT( [    1.9681,    2.5928,    2.8286,    3.3243] as t),
STRUCT( [    1.9681,    2.5928,    2.8285,    3.3242] as t),
STRUCT( [    1.9681,    2.5927,    2.8285,    3.3240] as t),
STRUCT( [    1.9681,    2.5927,    2.8284,    3.3239] as t),
STRUCT( [    1.9680,    2.5926,    2.8283,    3.3238] as t),
STRUCT( [    1.9680,    2.5925,    2.8282,    3.3237] as t),
STRUCT( [    1.9680,    2.5925,    2.8282,    3.3236] as t),
STRUCT( [    1.9680,    2.5924,    2.8281,    3.3235] as t),
STRUCT( [    1.9679,    2.5924,    2.8280,    3.3234] as t),
STRUCT( [    1.9679,    2.5923,    2.8279,    3.3233] as t),
STRUCT( [    1.9679,    2.5923,    2.8279,    3.3231] as t),
STRUCT( [    1.9679,    2.5922,    2.8278,    3.3230] as t),
STRUCT( [    1.9678,    2.5922,    2.8277,    3.3229] as t),
STRUCT( [    1.9678,    2.5921,    2.8277,    3.3228] as t),
STRUCT( [    1.9678,    2.5920,    2.8276,    3.3227] as t),
STRUCT( [    1.9677,    2.5920,    2.8275,    3.3226] as t),
STRUCT( [    1.9677,    2.5919,    2.8275,    3.3225] as t),
STRUCT( [    1.9677,    2.5919,    2.8274,    3.3224] as t),
STRUCT( [    1.9677,    2.5918,    2.8273,    3.3223] as t),
STRUCT( [    1.9676,    2.5918,    2.8273,    3.3222] as t),
STRUCT( [    1.9676,    2.5917,    2.8272,    3.3221] as t),
STRUCT( [    1.9676,    2.5917,    2.8271,    3.3220] as t),
STRUCT( [    1.9676,    2.5916,    2.8271,    3.3219] as t),
STRUCT( [    1.9675,    2.5916,    2.8270,    3.3218] as t),
STRUCT( [    1.9675,    2.5915,    2.8269,    3.3217] as t),
STRUCT( [    1.9675,    2.5915,    2.8269,    3.3216] as t),
STRUCT( [    1.9675,    2.5914,    2.8268,    3.3215] as t),
STRUCT( [    1.9675,    2.5914,    2.8268,    3.3214] as t),
STRUCT( [    1.9674,    2.5913,    2.8267,    3.3213] as t),
STRUCT( [    1.9674,    2.5913,    2.8266,    3.3212] as t),
STRUCT( [    1.9674,    2.5912,    2.8266,    3.3211] as t),
STRUCT( [    1.9674,    2.5912,    2.8265,    3.3210] as t),
STRUCT( [    1.9673,    2.5911,    2.8264,    3.3209] as t),
STRUCT( [    1.9673,    2.5911,    2.8264,    3.3208] as t),
STRUCT( [    1.9673,    2.5910,    2.8263,    3.3207] as t),
STRUCT( [    1.9673,    2.5910,    2.8263,    3.3206] as t),
STRUCT( [    1.9672,    2.5909,    2.8262,    3.3205] as t),
STRUCT( [    1.9672,    2.5909,    2.8262,    3.3204] as t),
STRUCT( [    1.9672,    2.5909,    2.8261,    3.3203] as t),
STRUCT( [    1.9672,    2.5908,    2.8260,    3.3203] as t),
STRUCT( [    1.9672,    2.5908,    2.8260,    3.3202] as t),
STRUCT( [    1.9671,    2.5907,    2.8259,    3.3201] as t),
STRUCT( [    1.9671,    2.5907,    2.8259,    3.3200] as t),
STRUCT( [    1.9671,    2.5906,    2.8258,    3.3199] as t),
STRUCT( [    1.9671,    2.5906,    2.8257,    3.3198] as t),
STRUCT( [    1.9670,    2.5905,    2.8257,    3.3197] as t),
STRUCT( [    1.9670,    2.5905,    2.8256,    3.3196] as t),
STRUCT( [    1.9670,    2.5905,    2.8256,    3.3195] as t),
STRUCT( [    1.9670,    2.5904,    2.8255,    3.3195] as t),
STRUCT( [    1.9670,    2.5904,    2.8255,    3.3194] as t),
STRUCT( [    1.9669,    2.5903,    2.8254,    3.3193] as t),
STRUCT( [    1.9669,    2.5903,    2.8254,    3.3192] as t),
STRUCT( [    1.9669,    2.5902,    2.8253,    3.3191] as t),
STRUCT( [    1.9669,    2.5902,    2.8253,    3.3190] as t),
STRUCT( [    1.9669,    2.5902,    2.8252,    3.3189] as t),
STRUCT( [    1.9668,    2.5901,    2.8252,    3.3189] as t),
STRUCT( [    1.9668,    2.5901,    2.8251,    3.3188] as t),
STRUCT( [    1.9668,    2.5900,    2.8250,    3.3187] as t),
STRUCT( [    1.9668,    2.5900,    2.8250,    3.3186] as t),
STRUCT( [    1.9668,    2.5899,    2.8249,    3.3185] as t),
STRUCT( [    1.9667,    2.5899,    2.8249,    3.3185] as t),
STRUCT( [    1.9667,    2.5899,    2.8248,    3.3184] as t),
STRUCT( [    1.9667,    2.5898,    2.8248,    3.3183] as t),
STRUCT( [    1.9667,    2.5898,    2.8247,    3.3182] as t),
STRUCT( [    1.9667,    2.5897,    2.8247,    3.3181] as t),
STRUCT( [    1.9666,    2.5897,    2.8246,    3.3181] as t),
STRUCT( [    1.9666,    2.5897,    2.8246,    3.3180] as t),
STRUCT( [    1.9666,    2.5896,    2.8245,    3.3179] as t),
STRUCT( [    1.9666,    2.5896,    2.8245,    3.3178] as t),
STRUCT( [    1.9666,    2.5896,    2.8244,    3.3178] as t),
STRUCT( [    1.9666,    2.5895,    2.8244,    3.3177] as t),
STRUCT( [    1.9665,    2.5895,    2.8243,    3.3176] as t),
STRUCT( [    1.9665,    2.5894,    2.8243,    3.3175] as t),
STRUCT( [    1.9665,    2.5894,    2.8242,    3.3175] as t),
STRUCT( [    1.9665,    2.5894,    2.8242,    3.3174] as t),
STRUCT( [    1.9665,    2.5893,    2.8242,    3.3173] as t),
STRUCT( [    1.9664,    2.5893,    2.8241,    3.3172] as t),
STRUCT( [    1.9664,    2.5893,    2.8241,    3.3172] as t),
STRUCT( [    1.9664,    2.5892,    2.8240,    3.3171] as t),
STRUCT( [    1.9664,    2.5892,    2.8240,    3.3170] as t),
STRUCT( [    1.9664,    2.5891,    2.8239,    3.3169] as t),
STRUCT( [    1.9664,    2.5891,    2.8239,    3.3169] as t),
STRUCT( [    1.9663,    2.5891,    2.8238,    3.3168] as t),
STRUCT( [    1.9663,    2.5890,    2.8238,    3.3167] as t),
STRUCT( [    1.9663,    2.5890,    2.8237,    3.3167] as t),
STRUCT( [    1.9663,    2.5890,    2.8237,    3.3166] as t),
STRUCT( [    1.9663,    2.5889,    2.8237,    3.3165] as t),
STRUCT( [    1.9663,    2.5889,    2.8236,    3.3165] as t),
STRUCT( [    1.9662,    2.5889,    2.8236,    3.3164] as t),
STRUCT( [    1.9662,    2.5888,    2.8235,    3.3163] as t),
STRUCT( [    1.9662,    2.5888,    2.8235,    3.3162] as t),
STRUCT( [    1.9662,    2.5888,    2.8234,    3.3162] as t),
STRUCT( [    1.9662,    2.5887,    2.8234,    3.3161] as t),
STRUCT( [    1.9662,    2.5887,    2.8233,    3.3160] as t),
STRUCT( [    1.9661,    2.5887,    2.8233,    3.3160] as t),
STRUCT( [    1.9661,    2.5886,    2.8233,    3.3159] as t),
STRUCT( [    1.9661,    2.5886,    2.8232,    3.3158] as t),
STRUCT( [    1.9661,    2.5886,    2.8232,    3.3158] as t),
STRUCT( [    1.9661,    2.5885,    2.8231,    3.3157] as t),
STRUCT( [    1.9661,    2.5885,    2.8231,    3.3156] as t),
STRUCT( [    1.9660,    2.5885,    2.8231,    3.3156] as t),
STRUCT( [    1.9660,    2.5884,    2.8230,    3.3155] as t),
STRUCT( [    1.9660,    2.5884,    2.8230,    3.3155] as t),
STRUCT( [    1.9660,    2.5884,    2.8229,    3.3154] as t),
STRUCT( [    1.9660,    2.5883,    2.8229,    3.3153] as t),
STRUCT( [    1.9660,    2.5883,    2.8229,    3.3153] as t),
STRUCT( [    1.9660,    2.5883,    2.8228,    3.3152] as t),
STRUCT( [    1.9659,    2.5882,    2.8228,    3.3151] as t),
STRUCT( [    1.9659,    2.5882,    2.8227,    3.3151] as t),
STRUCT( [    1.9659,    2.5882,    2.8227,    3.3150] as t),
STRUCT( [    1.9659,    2.5881,    2.8227,    3.3150] as t),
STRUCT( [    1.9659,    2.5881,    2.8226,    3.3149] as t),
STRUCT( [    1.9659,    2.5881,    2.8226,    3.3148] as t),
STRUCT( [    1.9659,    2.5881,    2.8225,    3.3148] as t),
STRUCT( [    1.9658,    2.5880,    2.8225,    3.3147] as t),
STRUCT( [    1.9658,    2.5880,    2.8225,    3.3147] as t),
STRUCT( [    1.9658,    2.5880,    2.8224,    3.3146] as t),
STRUCT( [    1.9658,    2.5879,    2.8224,    3.3145] as t),
STRUCT( [    1.9658,    2.5879,    2.8223,    3.3145] as t),
STRUCT( [    1.9658,    2.5879,    2.8223,    3.3144] as t),
STRUCT( [    1.9658,    2.5878,    2.8223,    3.3144] as t),
STRUCT( [    1.9657,    2.5878,    2.8222,    3.3143] as t),
STRUCT( [    1.9657,    2.5878,    2.8222,    3.3142] as t),
STRUCT( [    1.9657,    2.5878,    2.8222,    3.3142] as t),
STRUCT( [    1.9657,    2.5877,    2.8221,    3.3141] as t),
STRUCT( [    1.9657,    2.5877,    2.8221,    3.3141] as t),
STRUCT( [    1.9657,    2.5877,    2.8221,    3.3140] as t),
STRUCT( [    1.9657,    2.5876,    2.8220,    3.3140] as t),
STRUCT( [    1.9656,    2.5876,    2.8220,    3.3139] as t),
STRUCT( [    1.9656,    2.5876,    2.8219,    3.3138] as t),
STRUCT( [    1.9656,    2.5876,    2.8219,    3.3138] as t),
STRUCT( [    1.9656,    2.5875,    2.8219,    3.3137] as t),
STRUCT( [    1.9656,    2.5875,    2.8218,    3.3137] as t),
STRUCT( [    1.9656,    2.5875,    2.8218,    3.3136] as t),
STRUCT( [    1.9656,    2.5874,    2.8218,    3.3136] as t),
STRUCT( [    1.9655,    2.5874,    2.8217,    3.3135] as t),
STRUCT( [    1.9655,    2.5874,    2.8217,    3.3135] as t),
STRUCT( [    1.9655,    2.5874,    2.8217,    3.3134] as t),
STRUCT( [    1.9655,    2.5873,    2.8216,    3.3133] as t),
STRUCT( [    1.9655,    2.5873,    2.8216,    3.3133] as t),
STRUCT( [    1.9655,    2.5873,    2.8216,    3.3132] as t),
STRUCT( [    1.9655,    2.5873,    2.8215,    3.3132] as t),
STRUCT( [    1.9655,    2.5872,    2.8215,    3.3131] as t),
STRUCT( [    1.9654,    2.5872,    2.8215,    3.3131] as t),
STRUCT( [    1.9654,    2.5872,    2.8214,    3.3130] as t),
STRUCT( [    1.9654,    2.5872,    2.8214,    3.3130] as t),
STRUCT( [    1.9654,    2.5871,    2.8214,    3.3129] as t),
STRUCT( [    1.9654,    2.5871,    2.8213,    3.3129] as t),
STRUCT( [    1.9654,    2.5871,    2.8213,    3.3128] as t),
STRUCT( [    1.9654,    2.5870,    2.8213,    3.3128] as t),
STRUCT( [    1.9654,    2.5870,    2.8212,    3.3127] as t),
STRUCT( [    1.9653,    2.5870,    2.8212,    3.3127] as t),
STRUCT( [    1.9653,    2.5870,    2.8212,    3.3126] as t),
STRUCT( [    1.9653,    2.5869,    2.8211,    3.3126] as t),
STRUCT( [    1.9653,    2.5869,    2.8211,    3.3125] as t),
STRUCT( [    1.9653,    2.5869,    2.8211,    3.3125] as t),
STRUCT( [    1.9653,    2.5869,    2.8210,    3.3124] as t),
STRUCT( [    1.9653,    2.5868,    2.8210,    3.3124] as t),
STRUCT( [    1.9653,    2.5868,    2.8210,    3.3123] as t),
STRUCT( [    1.9652,    2.5868,    2.8209,    3.3123] as t),
STRUCT( [    1.9652,    2.5868,    2.8209,    3.3122] as t),
STRUCT( [    1.9652,    2.5867,    2.8209,    3.3122] as t),
STRUCT( [    1.9652,    2.5867,    2.8209,    3.3121] as t),
STRUCT( [    1.9652,    2.5867,    2.8208,    3.3121] as t),
STRUCT( [    1.9652,    2.5867,    2.8208,    3.3120] as t),
STRUCT( [    1.9652,    2.5867,    2.8208,    3.3120] as t),
STRUCT( [    1.9652,    2.5866,    2.8207,    3.3119] as t),
STRUCT( [    1.9652,    2.5866,    2.8207,    3.3119] as t),
STRUCT( [    1.9651,    2.5866,    2.8207,    3.3118] as t),
STRUCT( [    1.9651,    2.5866,    2.8206,    3.3118] as t),
STRUCT( [    1.9651,    2.5865,    2.8206,    3.3118] as t),
STRUCT( [    1.9651,    2.5865,    2.8206,    3.3117] as t),
STRUCT( [    1.9651,    2.5865,    2.8206,    3.3117] as t),
STRUCT( [    1.9651,    2.5865,    2.8205,    3.3116] as t),
STRUCT( [    1.9651,    2.5864,    2.8205,    3.3116] as t),
STRUCT( [    1.9651,    2.5864,    2.8205,    3.3115] as t),
STRUCT( [    1.9651,    2.5864,    2.8204,    3.3115] as t),
STRUCT( [    1.9650,    2.5864,    2.8204,    3.3114] as t),
STRUCT( [    1.9650,    2.5864,    2.8204,    3.3114] as t),
STRUCT( [    1.9650,    2.5863,    2.8204,    3.3113] as t),
STRUCT( [    1.9650,    2.5863,    2.8203,    3.3113] as t),
STRUCT( [    1.9650,    2.5863,    2.8203,    3.3113] as t),
STRUCT( [    1.9650,    2.5863,    2.8203,    3.3112] as t),
STRUCT( [    1.9650,    2.5862,    2.8202,    3.3112] as t),
STRUCT( [    1.9650,    2.5862,    2.8202,    3.3111] as t),
STRUCT( [    1.9650,    2.5862,    2.8202,    3.3111] as t),
STRUCT( [    1.9649,    2.5862,    2.8202,    3.3110] as t),
STRUCT( [    1.9649,    2.5862,    2.8201,    3.3110] as t),
STRUCT( [    1.9649,    2.5861,    2.8201,    3.3110] as t),
STRUCT( [    1.9649,    2.5861,    2.8201,    3.3109] as t),
STRUCT( [    1.9649,    2.5861,    2.8200,    3.3109] as t),
STRUCT( [    1.9649,    2.5861,    2.8200,    3.3108] as t),
STRUCT( [    1.9649,    2.5860,    2.8200,    3.3108] as t),
STRUCT( [    1.9649,    2.5860,    2.8200,    3.3107] as t),
STRUCT( [    1.9649,    2.5860,    2.8199,    3.3107] as t),
STRUCT( [    1.9649,    2.5860,    2.8199,    3.3107] as t),
STRUCT( [    1.9648,    2.5860,    2.8199,    3.3106] as t),
STRUCT( [    1.9648,    2.5859,    2.8199,    3.3106] as t),
STRUCT( [    1.9648,    2.5859,    2.8198,    3.3105] as t),
STRUCT( [    1.9648,    2.5859,    2.8198,    3.3105] as t),
STRUCT( [    1.9648,    2.5859,    2.8198,    3.3105] as t),
STRUCT( [    1.9648,    2.5859,    2.8198,    3.3104] as t),
STRUCT( [    1.9648,    2.5858,    2.8197,    3.3104] as t),
STRUCT( [    1.9648,    2.5858,    2.8197,    3.3103] as t),
STRUCT( [    1.9648,    2.5858,    2.8197,    3.3103] as t),
STRUCT( [    1.9648,    2.5858,    2.8196,    3.3102] as t),
STRUCT( [    1.9647,    2.5858,    2.8196,    3.3102] as t),
STRUCT( [    1.9647,    2.5857,    2.8196,    3.3102] as t),
STRUCT( [    1.9647,    2.5857,    2.8196,    3.3101] as t),
STRUCT( [    1.9647,    2.5857,    2.8195,    3.3101] as t)]
AS CriticalValues )

SELECT
        CASE
        WHEN IS_INF(tscore) THEN 0.0
        WHEN tscore > CriticalValues[ORDINAL(df)].t[ORDINAL(4)] THEN 0.001
        WHEN tscore > CriticalValues[ORDINAL(df)].t[ORDINAL(3)] THEN 0.005
        WHEN tscore > CriticalValues[ORDINAL(df)].t[ORDINAL(2)] THEN 0.01
        WHEN tscore > CriticalValues[ORDINAL(df)].t[ORDINAL(1)] THEN 0.05
        ELSE 1
        END
FROM  Ttable
)
)
